# ============================================================================
# Security Audit Configuration
# ============================================================================
# Focus: Security posture, compliance, access controls
# Use case: Security assessments, compliance audits
#
# Usage: python assess_storage.py --config examples/scenarios/security-audit.yaml

# ============================================================================
# SCOPE
# ============================================================================
scope:
  subscriptions: []  # Empty = all subscriptions
  resource_groups: []
  locations: []
  required_tags: {}

# ============================================================================
# STALE DATA ANALYSIS (MINIMAL)
# ============================================================================
stale_data:
  threshold_days: 180  # Longer threshold for security focus
  check_last_access: false
  sample_size: 1000  # Small sample for speed
  max_container_size: 1000000
  max_files_to_scan: 1000
  large_file_threshold_mb: 100

# ============================================================================
# COST OPTIMIZATION (DISABLED - NOT THE FOCUS)
# ============================================================================
cost_analysis:
  enabled: false
  pricing_region: "eastus"
  calculate_savings: false
  workload_profile: "light"
  
  tier_recommendations:
    cool_tier_days: 30
    archive_tier_days: 180
    min_size_gb: 1

# ============================================================================
# SECURITY (PRIMARY FOCUS)
# ============================================================================
security:
  check_public_access: true
  check_encryption: true
  check_network_rules: true
  check_auth_methods: true
  check_soft_delete: true
  check_versioning: true
  check_defender: true
  check_https_only: true
  minimum_tls_version: "TLS1_2"

# ============================================================================
# GOVERNANCE (SECONDARY FOCUS)
# ============================================================================
governance:
  required_tags:
    - "Environment"
    - "Owner"
    - "CostCenter"
  check_lifecycle_policies: true
  check_diagnostics: true
  check_resource_locks: true
  naming_pattern: "^st[a-z0-9]{3,22}$"

# ============================================================================
# METRICS (ENABLED FOR SECURITY ANALYSIS)
# ============================================================================
metrics:
  enabled: true
  retention_days: 30
  metrics_list:
    - "Transactions"
    - "Availability"
  time_grain: "PT1D"

# ============================================================================
# OUTPUT & REPORTING
# ============================================================================
output:
  directory: "./reports"
  formats:
    - "pdf"   # Executive summary
    - "csv"   # Detailed findings
    - "json"  # For SIEM integration
  include_details: true
  include_recommendations: true
  sanitize_output: false
  compress: false

# ============================================================================
# EXECUTION
# ============================================================================
execution:
  quick_mode: false  # Thorough security assessment
  parallel:
    enabled: true
    max_workers: 5
  rate_limit: 10
  retries:
    max_attempts: 3
    backoff_factor: 2
  timeout: 60
  verbose: true

# ============================================================================
# ADVANCED
# ============================================================================
advanced:
  include_empty_accounts: true
  detect_orphans: false
  analyze_access_patterns: false
  preview_features: false
  custom_checks: []
