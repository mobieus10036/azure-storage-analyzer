# Azure Storage Assessment Toolkit - Configuration

# ============================================================================
# ASSESSMENT SCOPE
# ============================================================================
scope:
  # Limit to specific subscriptions (empty = all accessible subscriptions)
  subscriptions: []
  
  # Limit to specific resource groups (empty = all resource groups)
  resource_groups: []
  
  # Filter by location (empty = all locations)
  locations: []
  
  # Filter by tags (empty = no filtering)
  required_tags: {}
    # Example:
    # Environment: Production
    # CostCenter: IT

# ============================================================================
# STALE DATA ANALYSIS
# ============================================================================
stale_data:
  # Days without access to consider a blob "stale"
  threshold_days: 90
  
  # Analyze last access time (requires analytics logging enabled)
  check_last_access: true
  
  # Sample size for large containers (0 = analyze all blobs)
  # Use sampling for containers with millions of blobs
  sample_size: 10000
  
  # Skip containers larger than this blob count (for performance)
  max_container_size: 1000000
  
  # File share settings
  max_files_to_scan: 10000  # Maximum files to scan per share (for performance)
  large_file_threshold_mb: 100  # Files larger than this are flagged

# ============================================================================
# COST OPTIMIZATION
# ============================================================================
cost_analysis:
  # Include cost estimates in reports
  enabled: true
  
  # Pricing region (used for cost calculations)
  pricing_region: "eastus"
  
  # Calculate potential savings from tier optimization
  calculate_savings: true
  
  # Workload profile for Azure Files transaction cost estimation
  # Options: 
  #   "auto"     - Automatically detect based on file share names (recommended)
  #   "light"    - Basic file storage, infrequent access (~$0.10/GB/month)
  #   "moderate" - Typical file shares, regular access (~$0.20/GB/month)  
  #   "heavy"    - FSLogix, AVD profiles, high transactions (~$0.48/GB/month)
  # Note: Transaction costs vary significantly by actual usage - estimates are approximate
  workload_profile: "auto"  # Auto-detect FSLogix/AVD and other workloads
  
  # Tier optimization rules
  tier_recommendations:
    # Suggest Cool tier if not accessed for X days
    cool_tier_days: 30
    
    # Suggest Archive tier if not accessed for X days
    archive_tier_days: 180
    
    # Minimum size (GB) to recommend tier change
    min_size_gb: 1

# ============================================================================
# SECURITY & COMPLIANCE CHECKS
# ============================================================================
security:
  # Check for public blob access
  check_public_access: true
  
  # Verify encryption settings
  check_encryption: true
  
  # Audit network rules (firewall, VNet, private endpoints)
  check_network_rules: true
  
  # Verify authentication methods
  check_auth_methods: true
  
  # Check soft delete configuration
  check_soft_delete: true
  
  # Check blob versioning
  check_versioning: true
  
  # Check Microsoft Defender for Storage
  check_defender: true
  
  # Check for HTTPS-only traffic
  check_https_only: true
  
  # Verify minimum TLS version
  minimum_tls_version: "TLS1_2"

# ============================================================================
# GOVERNANCE & COMPLIANCE
# ============================================================================
governance:
  # Required tags for compliance
  required_tags:
    - Environment
    - Owner
    - CostCenter
  
  # Check for lifecycle management policies
  check_lifecycle_policies: true
  
  # Verify diagnostic settings
  check_diagnostics: true
  
  # Check for resource locks
  check_resource_locks: false
  
  # Validate naming conventions (regex pattern)
  naming_pattern: "^st[a-z0-9]{3,22}$"

# ============================================================================
# PERFORMANCE & METRICS
# ============================================================================
metrics:
  # Collect Azure Monitor metrics
  enabled: true
  
  # Metrics retention period (days)
  retention_days: 30
  
  # Metrics to collect
  metrics_list:
    - "Transactions"
    - "Ingress"
    - "Egress"
    - "SuccessServerLatency"
    - "Availability"
  
  # Time granularity for metrics (PT1H, PT1D, etc.)
  time_grain: "PT1D"

# ============================================================================
# OUTPUT & REPORTING
# ============================================================================
output:
  # Output directory
  directory: "./reports"
  
  # Output formats
  formats:
    - "json"
    - "csv"
    - "markdown"
    - "pdf"
  
  # Include detailed findings in reports
  include_details: true
  
  # Include recommendations
  include_recommendations: true
  
  # Sanitize sensitive data (resource IDs, account names)
  sanitize_output: false
  
  # Compress output files
  compress: false

# ============================================================================
# EXECUTION OPTIONS
# ============================================================================
execution:
  # Quick mode (skip detailed blob analysis)
  quick_mode: false
  
  # Parallel processing
  parallel:
    enabled: true
    max_workers: 5
  
  # Rate limiting (requests per second)
  rate_limit: 10
  
  # Retry configuration
  retries:
    max_attempts: 3
    backoff_factor: 2
  
  # Timeout (seconds) for API calls
  timeout: 30
  
  # Verbose logging
  verbose: false

# ============================================================================
# ADVANCED OPTIONS
# ============================================================================
advanced:
  # Include empty storage accounts in report
  include_empty_accounts: true
  
  # Check for orphaned resources
  detect_orphans: true
  
  # Analyze access patterns
  analyze_access_patterns: true
  
  # Include preview features
  preview_features: false
  
  # Custom checks (Python scripts)
  custom_checks: []
